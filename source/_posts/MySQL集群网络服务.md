---
title: MySQL集群网络服务
date: 2020-07-09 14:30:14
tags:
---
#### MySQL一主多从，主库宕机，如何合理切换到从库，其他从库如何处理？

##### 主从服务器原理

技术点：bin-log日志

- 开启主服务器的bin-log日志记录功能，将主服务器的bin-log日志传到从服务器，从服务器根据日志内容将数据还原到本地

主从服务器：

- 从服务器主动把主服务器上的数据同步到本地（备份）
<!-- more -->
##### 主从故障切换

- 登陆所有从库查看post信息，使用POST最大的作为新的主库，然后将从库提升为新的主库，登陆从库（新的主库）执行stop slave

- 修改my.cnf配置文件，开启log-bin并重新启动数据库服务，登陆数据库执行reset master ，show masterstatus\G；查看主库信息，最后创建授权同步用户与权限和网站使用数据库的用户与权限，最后修改对应服务器的IP地址等信息

- 登陆其他从库，执行change master操作，查看同步状态。


---
#### 单台MySQL达到性能瓶颈时，如何击碎性能瓶颈？

##### 数据库代理工具：Amoeba

Amoeba致力于MySQL的分布式数据库前端代理层，它主要在应用层访问MySQL的时候充当SQL路由功能，专注于分布式数据库代理层（database proxy）开发。具有负载均衡、高可用性、SQL过滤、读写分离、可路由相关的目标数据库、可并发请求多台数据库合并结果，通过Amoeba你能够完成多数据源的高可用、负载均衡、数据切片的功能

